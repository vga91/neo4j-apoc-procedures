<html>

<head>
    <meta charset="UTF-8">
    <!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Asciidoctor 1.5.3">
    <title>Neo4j APOC Procedures User Guide</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
    <style>
        /* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
        /* Remove comment around @import statement below when using as a custom stylesheet */
        /*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
        article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
        audio,canvas,video{display:inline-block}
        audio:not([controls]){display:none;height:0}
        [hidden],template{display:none}
        script{display:none!important}
        html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
        body{margin:0}
        a{background:transparent}
        a:focus{outline:thin dotted}
        a:active,a:hover{outline:0}
        h1{font-size:2em;margin:.67em 0}
        abbr[title]{border-bottom:1px dotted}
        b,strong{font-weight:bold}
        dfn{font-style:italic}
        hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
        mark{background:#ff0;color:#000}
        code,kbd,pre,samp{font-family:monospace;font-size:1em}
        pre{white-space:pre-wrap}
        q{quotes:"\201C" "\201D" "\2018" "\2019"}
        small{font-size:80%}
        sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
        sup{top:-.5em}
        sub{bottom:-.25em}
        img{border:0}
        svg:not(:root){overflow:hidden}
        figure{margin:0}
        fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
        legend{border:0;padding:0}
        button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
        button,input{line-height:normal}
        button,select{text-transform:none}
        button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
        button[disabled],html input[disabled]{cursor:default}
        input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
        input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
        input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
        button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
        textarea{overflow:auto;vertical-align:top}
        table{border-collapse:collapse;border-spacing:0}
        *,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
        html,body{font-size:100%}
        body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
        a:hover{cursor:pointer}
        img,object,embed{max-width:100%;height:auto}
        object,embed{height:100%}
        img{-ms-interpolation-mode:bicubic}
        .left{float:left!important}
        .right{float:right!important}
        .text-left{text-align:left!important}
        .text-right{text-align:right!important}
        .text-center{text-align:center!important}
        .text-justify{text-align:justify!important}
        .hide{display:none}
        body{-webkit-font-smoothing:antialiased}
        img,object,svg{display:inline-block;vertical-align:middle}
        textarea{height:auto;min-height:50px}
        select{width:100%}
        .center{margin-left:auto;margin-right:auto}
        .spread{width:100%}
        p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
        .subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
        div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
        a{color:#2156a5;text-decoration:underline;line-height:inherit}
        a:hover,a:focus{color:#1d4b8f}
        a img{border:none}
        p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
        p aside{font-size:.875em;line-height:1.35;font-style:italic}
        h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
        h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
        h1{font-size:2.125em}
        h2{font-size:1.6875em}
        h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
        h4,h5{font-size:1.125em}
        h6{font-size:1em}
        hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
        em,i{font-style:italic;line-height:inherit}
        strong,b{font-weight:bold;line-height:inherit}
        small{font-size:60%;line-height:inherit}
        code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
        ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
        ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
        ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
        ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
        ul.square{list-style-type:square}
        ul.circle{list-style-type:circle}
        ul.disc{list-style-type:disc}
        ul.no-bullet{list-style:none}
        ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
        dl dt{margin-bottom:.3125em;font-weight:bold}
        dl dd{margin-bottom:1.25em}
        abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
        abbr{text-transform:none}
        blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
        blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
        blockquote cite:before{content:"\2014 \0020"}
        blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
        blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
        @media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
            h1{font-size:2.75em}
            h2{font-size:2.3125em}
            h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
            h4{font-size:1.4375em}}
        table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
        table thead,table tfoot{background:#f7f8f7;font-weight:bold}
        table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
        table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
        table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
        table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
        body{tab-size:4}
        h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
        h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
        .clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
        .clearfix:after,.float-group:after{clear:both}
        *:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
        pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
        .keyseq{color:rgba(51,51,51,.8)}
        kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
        .keyseq kbd:first-child{margin-left:0}
        .keyseq kbd:last-child{margin-right:0}
        .menuseq,.menu{color:rgba(0,0,0,.8)}
        b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
        b.button:before{content:"[";padding:0 3px 0 2px}
        b.button:after{content:"]";padding:0 2px 0 3px}
        p a>code:hover{color:rgba(0,0,0,.9)}
        #header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
        #header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
        #header:after,#content:after,#footnotes:after,#footer:after{clear:both}
        #content{margin-top:1.25em}
        #content:before{content:none}
        #header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
        #header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
        #header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
        #header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
        #header .details span:first-child{margin-left:-.125em}
        #header .details span.email a{color:rgba(0,0,0,.85)}
        #header .details br{display:none}
        #header .details br+span:before{content:"\00a0\2013\00a0"}
        #header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
        #header .details br+span#revremark:before{content:"\00a0|\00a0"}
        #header #revnumber{text-transform:capitalize}
        #header #revnumber:after{content:"\00a0"}
        #content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
        #toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
        #toc>ul{margin-left:.125em}
        #toc ul.sectlevel0>li>a{font-style:italic}
        #toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
        #toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
        #toc li{line-height:1.3334;margin-top:.3334em}
        #toc a{text-decoration:none}
        #toc a:active{text-decoration:underline}
        #toctitle{color:#7a2518;font-size:1.2em}
        @media only screen and (min-width:768px){#toctitle{font-size:1.375em}
            body.toc2{padding-left:15em;padding-right:0}
            #toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
            #toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
            #toc.toc2>ul{font-size:.9em;margin-bottom:0}
            #toc.toc2 ul ul{margin-left:0;padding-left:1em}
            #toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
            body.toc2.toc-right{padding-left:0;padding-right:15em}
            body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
        @media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
            #toc.toc2{width:20em}
            #toc.toc2 #toctitle{font-size:1.375em}
            #toc.toc2>ul{font-size:.95em}
            #toc.toc2 ul ul{padding-left:1.25em}
            body.toc2.toc-right{padding-left:0;padding-right:20em}}
        #content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
        #content #toc>:first-child{margin-top:0}
        #content #toc>:last-child{margin-bottom:0}
        #footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
        #footer-text{color:rgba(255,255,255,.8);line-height:1.44}
        .sect1{padding-bottom:.625em}
        @media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
        .sect1+.sect1{border-top:1px solid #efefed}
        #content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
        #content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
        #content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
        #content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
        #content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
        .audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
        .admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
        table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
        .paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
        table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
        .admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
        .admonitionblock>table td.icon{text-align:center;width:80px}
        .admonitionblock>table td.icon img{max-width:none}
        .admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
        .admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
        .admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
        .exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
        .exampleblock>.content>:first-child{margin-top:0}
        .exampleblock>.content>:last-child{margin-bottom:0}
        .sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
        .sidebarblock>:first-child{margin-top:0}
        .sidebarblock>:last-child{margin-bottom:0}
        .sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
        .exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
        .literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
        .sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
        .literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
        .literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
        @media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
        @media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
        .literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
        .listingblock pre.highlightjs{padding:0}
        .listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
        .listingblock pre.prettyprint{border-width:0}
        .listingblock>.content{position:relative}
        .listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
        .listingblock:hover code[data-lang]:before{display:block}
        .listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
        .listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
        table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
        table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
        table.pyhltable td.code{padding-left:.75em;padding-right:0}
        pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
        pre.pygments .lineno{display:inline-block;margin-right:.25em}
        table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
        .quoteblock{margin:0 1em 1.25em 1.5em;display:table}
        .quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
        .quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
        .quoteblock blockquote{margin:0;padding:0;border:0}
        .quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
        .quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
        .quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
        .quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
        .quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
        .quoteblock .quoteblock blockquote:before{display:none}
        .verseblock{margin:0 1em 1.25em 1em}
        .verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
        .verseblock pre strong{font-weight:400}
        .verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
        .quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
        .quoteblock .attribution br,.verseblock .attribution br{display:none}
        .quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
        .quoteblock.abstract{margin:0 0 1.25em 0;display:block}
        .quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
        .quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
        table.tableblock{max-width:100%;border-collapse:separate}
        table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
        table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
        table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
        table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
        table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
        table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
        table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
        table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
        table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
        table.frame-all{border-width:1px}
        table.frame-sides{border-width:0 1px}
        table.frame-topbot{border-width:1px 0}
        th.halign-left,td.halign-left{text-align:left}
        th.halign-right,td.halign-right{text-align:right}
        th.halign-center,td.halign-center{text-align:center}
        th.valign-top,td.valign-top{vertical-align:top}
        th.valign-bottom,td.valign-bottom{vertical-align:bottom}
        th.valign-middle,td.valign-middle{vertical-align:middle}
        table thead th,table tfoot th{font-weight:bold}
        tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
        tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
        p.tableblock>code:only-child{background:none;padding:0}
        p.tableblock{font-size:1em}
        td>div.verse{white-space:pre}
        ol{margin-left:1.75em}
        ul li ol{margin-left:1.5em}
        dl dd{margin-left:1.125em}
        dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
        ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
        ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
        ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
        ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
        ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
        ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
        ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
        ul.inline>li>*{display:block}
        .unstyled dl dt{font-weight:400;font-style:normal}
        ol.arabic{list-style-type:decimal}
        ol.decimal{list-style-type:decimal-leading-zero}
        ol.loweralpha{list-style-type:lower-alpha}
        ol.upperalpha{list-style-type:upper-alpha}
        ol.lowerroman{list-style-type:lower-roman}
        ol.upperroman{list-style-type:upper-roman}
        ol.lowergreek{list-style-type:lower-greek}
        .hdlist>table,.colist>table{border:0;background:none}
        .hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
        td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
        td.hdlist1{font-weight:bold;padding-bottom:1.25em}
        .literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
        .colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
        .colist>table tr>td:last-of-type{padding:.25em 0}
        .thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
        .imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
        .imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
        .imageblock>.title{margin-bottom:0}
        .imageblock.thumb,.imageblock.th{border-width:6px}
        .imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
        .image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
        .image.left{margin-right:.625em}
        .image.right{margin-left:.625em}
        a.image{text-decoration:none;display:inline-block}
        a.image object{pointer-events:none}
        sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
        sup.footnote a,sup.footnoteref a{text-decoration:none}
        sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
        #footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
        #footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
        #footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
        #footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
        #footnotes .footnote:last-of-type{margin-bottom:0}
        #content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
        .gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
        .gist .file-data>table td.line-data{width:99%}
        div.unbreakable{page-break-inside:avoid}
        .big{font-size:larger}
        .small{font-size:smaller}
        .underline{text-decoration:underline}
        .overline{text-decoration:overline}
        .line-through{text-decoration:line-through}
        .aqua{color:#00bfbf}
        .aqua-background{background-color:#00fafa}
        .black{color:#000}
        .black-background{background-color:#000}
        .blue{color:#0000bf}
        .blue-background{background-color:#0000fa}
        .fuchsia{color:#bf00bf}
        .fuchsia-background{background-color:#fa00fa}
        .gray{color:#606060}
        .gray-background{background-color:#7d7d7d}
        .green{color:#006000}
        .green-background{background-color:#007d00}
        .lime{color:#00bf00}
        .lime-background{background-color:#00fa00}
        .maroon{color:#600000}
        .maroon-background{background-color:#7d0000}
        .navy{color:#000060}
        .navy-background{background-color:#00007d}
        .olive{color:#606000}
        .olive-background{background-color:#7d7d00}
        .purple{color:#600060}
        .purple-background{background-color:#7d007d}
        .red{color:#bf0000}
        .red-background{background-color:#fa0000}
        .silver{color:#909090}
        .silver-background{background-color:#bcbcbc}
        .teal{color:#006060}
        .teal-background{background-color:#007d7d}
        .white{color:#bfbfbf}
        .white-background{background-color:#fafafa}
        .yellow{color:#bfbf00}
        .yellow-background{background-color:#fafa00}
        span.icon>.fa{cursor:default}
        .admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
        .admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
        .admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
        .admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
        .admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
        .admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
        .conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
        .conum[data-value] *{color:#fff!important}
        .conum[data-value]+b{display:none}
        .conum[data-value]:after{content:attr(data-value)}
        pre .conum[data-value]{position:relative;top:-.125em}
        b.conum *{color:inherit!important}
        .conum:not([data-value]):empty{display:none}
        dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
        h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
        p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
        p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
        p{margin-bottom:1.25rem}
        .sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
        .exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
        .print-only{display:none!important}
        @media print{@page{margin:1.25cm .75cm}
            *{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
            a{color:inherit!important;text-decoration:underline!important}
            a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
            a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
            abbr[title]:after{content:" (" attr(title) ")"}
            pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
            thead{display:table-header-group}
            svg{max-width:100%}
            p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
            h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
            #toc,.sidebarblock,.exampleblock>.content{background:none!important}
            #toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
            .sect1{padding-bottom:0!important}
            .sect1+.sect1{border:0!important}
            #header>h1:first-child{margin-top:1.25rem}
            body.book #header{text-align:center}
            body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
            body.book #header .details{border:0!important;display:block;padding:0!important}
            body.book #header .details span:first-child{margin-left:0!important}
            body.book #header .details br{display:block}
            body.book #header .details br+span:before{content:none!important}
            body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
            body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
            .listingblock code[data-lang]:before{display:block}
            #footer{background:none!important;padding:0 .9375em}
            #footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
            .hide-on-print{display:none!important}
            .print-only{display:block!important}
            .hide-for-print{display:none!important}
            .show-for-print{display:inherit!important}}
    </style>
    <meta http-equiv="refresh" content="5; url=https://neo4j.com/docs/labs/apoc/current/" />

</head>



<body class="article toc2 toc-left">
<div id="header">

    <h1>Neo4j Streams User Guide</h1>

</div>

<div id="content">
    <div class="sect1">
        <h2 id="_introduction"><a class="link" href="#_introduction">Guide moved to neo4j.com/docs/labs</a></h2>
        <div class="sectionbody">
            <div class="paragraph">
                <p>
                    This guide has been moved to <a href="https://neo4j.com/docs/labs/apoc/current/">neo4j.com/docs/labs/apoc/current/</a>

                </p>
                <p>
                    You will be redirected in 5 seconds but <a href="https://neo4j.com/docs/labs/apoc/current/">click this link</a> if your browser doesn't automatically redirect you.
                </p>
            </div>
        </div>
    </div>
</div>

</body>

</html>teve',age:34, eyes:'blue'}),
    (m:Person{name:'Jake',hair:'brown',age:34})
WITH n,m
return apoc.diff.nodes(n,m)</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Resulting JSON body:</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "leftOnly": {
    "eyes": "blue"
  },
  "inCommon": {
    "age": 34
  },
  "different": {
    "name": {
      "left": "Steve",
      "right": "Jake"
    }
  },
  "rightOnly": {
    "hair": "brown"
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="bitwise-operations"><a class="link" href="#bitwise-operations">Bitwise operations</a></h3>
<div class="paragraph">
<p>Provides a wrapper around the java bitwise operations.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">apoc.bitwise.op(a long, "operation", b long ) as &lt;identifier&gt;</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>examples</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">example</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">result</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">a &amp; b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AND</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">apoc.bitwise.op(60,"&amp;",13)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">a | b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">apoc.bitwise.op(60,"|",13)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">61</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">a ^ b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XOR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">apoc.bitwise.op(60,"&amp;",13)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">49</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">~a</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NOT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">apoc.bitwise.op(60,"&amp;",0)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-61</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">a &lt;&lt; b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LEFT SHIFT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">apoc.bitwise.op(60,"&lt;&lt;",2)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">240</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">a &gt;&gt; b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RIGHT SHIFT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">apoc.bitwise.op(60,"&gt;&gt;",2)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">15</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">a &gt;&gt;&gt; b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">UNSIGNED RIGHT SHIFT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">apoc.bitwise.op(60,"&gt;&gt;&gt;",2)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">15</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="atomic-updates"><a class="link" href="#atomic-updates">Atomic</a></h3>
<div class="paragraph">
<p>Atomic procedures handle the concurrency, it&#8217;s add a lock to the resource.
If two users access to the same resource at the same time, with the parameter <code>times</code> (default value 5) we can determine how many time retry to modify the resource, until the lock is release.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL apoc.atomic.add(node/relationship, "property", number, [times]) YIELD oldValue, newValue</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">adds the number to the value of the property</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL apoc.atomic.subtract(node/relationship, "property", number, [times]) YIELD oldValue, newValue</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">subtracts the number to the value of the property</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL apoc.atomic.concat(node/relationship, "property", "string", [times]) YIELD oldValue, newValue</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">concatenate the string to the property</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL apoc.atomic.insert(node/relationship, "property", position, object, [times]) YIELD oldValue, newValue</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">inserts the object in the chosen position of the array</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL apoc.atomic.remove(node/relationship, "property", position, [times]) YIELD oldValue, newValue</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">remove from the array the element to the position selected</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL apoc.atomic.update(node/relationship, "property", "expression", [times]) YIELD oldValue, newValue</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">update the property with the result of the expression</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_atomic_examples"><a class="link" href="#_atomic_examples">Atomic Examples</a></h3>
<div class="paragraph">
<div class="title">add</div>
<p>Dataset</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CREATE (p:Person {name:'Tom',age: 40})</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can add 10 to the property <code>age</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">MATCH (n:Person {name:'Tom'})
CALL apoc.atomic.add(n,'age',10,5) YIELD oldValue, newValue
RETURN n</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="https://raw.githubusercontent.com/neo4j-contrib/neo4j-apoc-procedures/3.4/docs/images/apoc.atomic.add.png" alt="apoc.atomic.add" width="800">
</div>
</div>
<div class="paragraph">
<div class="title">subtract</div>
<p>From the previous example we can go back to <code>age</code>: 40</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">MATCH (n:Person {name:'Tom'})
CALL apoc.atomic.subtract(n,'age',10,5) YIELD oldValue, newValue
RETURN n</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">concat</div>
<p>Dataset</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CREATE (p:Person {name:'Will',age: 35})</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">MATCH (p:Person {name:'Will',age: 35})
CALL apoc.atomic.concat(p,"name",'iam',5) YIELD newValue
RETURN p</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="https://raw.githubusercontent.com/neo4j-contrib/neo4j-apoc-procedures/3.4/docs/images/apoc.atomic.concat.png" alt="apoc.atomic.concat" width="800">
</div>
</div>
<div class="paragraph">
<div class="title">insert</div>
<p>Dataset</p>
</div>
<div class="paragraph">
<p>we add a propery <code>children</code> that is an array</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CREATE (p:Person {name:'Tom', children: ['Anne','Sam','Paul']})</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="https://raw.githubusercontent.com/neo4j-contrib/neo4j-apoc-procedures/3.4/docs/images/apoc.atomic.insert.png" alt="apoc.atomic.insert" width="800">
</div>
</div>
<div class="paragraph">
<p>Now we add <code>Mary</code> to propery children at the position 2</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">MATCH (p:Person {name:'Tom'})
CALL apoc.atomic.insert(p,'children',2,'Mary',5) YIELD newValue
RETURN p</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="https://raw.githubusercontent.com/neo4j-contrib/neo4j-apoc-procedures/3.4/docs/images/apoc.atomic.insert.result.png" alt="apoc.atomic.insert.result" width="800">
</div>
</div>
<div class="paragraph">
<div class="title">remove</div>
<p>Dataset</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CREATE (p:Person {name:'Tom', cars: ['Class A','X3','Focus']})</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now we remove the element <code>X3</code> which is at the position 1 from the array <code>cars</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">MATCH (p:Person {name:'Tom'})
CALL apoc.atomic.remove(p,'cars',1,5) YIELD newValue
RETURN p</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="https://raw.githubusercontent.com/neo4j-contrib/neo4j-apoc-procedures/3.4/docs/images/apoc.atomic.remove.png" alt="apoc.atomic.remove" width="800">
</div>
</div>
<div class="paragraph">
<div class="title">update</div>
<p>Dataset</p>
</div>
<div class="listingblock">
<div class="content">
<pre>CREATE (p:Person {name:'Tom', salary1:1800, salary2:1500})</pre>
</div>
</div>
<div class="paragraph">
<p>We want to update <code>salary1</code> with the result of an expression.
The expression always have to be referenced with the <code>n.</code> that refers to the node/rel passed as parameter.
If we rename our node/rel (as in the example above) we have anyway to refer to it in the expression as <code>n</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">MATCH (p:Person {name:'Tom'})
CALL apoc.atomic.update(p,'salary1','n.salary1*3 + n.salary2',5) YIELD newValue
RETURN p</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="https://raw.githubusercontent.com/neo4j-contrib/neo4j-apoc-procedures/3.4/docs/images/apoc.atomic.update.png" alt="apoc.atomic.update" width="800">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_log"><a class="link" href="#_log">Log</a></h3>
<div class="sect3">
<h4 id="log"><a class="link" href="#log">Log Procedures</a></h4>
<div class="paragraph">
<p>APOC provide a set of store procedures in order to add log functionality:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>apoc.log.info</code>: logs info message</p>
</li>
<li>
<p><code>apoc.log.error</code>: logs error message</p>
</li>
<li>
<p><code>apoc.log.warn</code>: logs warn message</p>
</li>
<li>
<p><code>apoc.log.debug</code>: logs debug message</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Every log procedure has the following signature:</p>
</div>
<div class="paragraph">
<p><code>apoc.log.&lt;name&gt;(message, params)</code></p>
</div>
<div class="paragraph">
<p>Available configuration:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">property</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><code>apoc.user.log.type</code></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>enum[none, safe, raw] (default value <code>safe</code>)</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>type of logging:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>node</code>: disable the procedures</p>
</li>
<li>
<p><code>safe</code>: replace all <code>.</code> and whitespace (space and tab) with underscore and lowercase all characters</p>
</li>
<li>
<p><code>raw</code>: left the messages as-is</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><code>apoc.user.log.window.ops</code></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>int (default value <code>10</code>)</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>num of logs permitted in a time-window, exceeded this quota every log message will be skip</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><code>apoc.user.log.window.time</code></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>long (default value <code>10000</code>)</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>the length (in milliseconds) of the time-window (default 10 seconds)</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="paragraph">
<p>The following call (with the default configuration):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">call apoc.log.info('Hello %s', ['World'])</code></pre>
</div>
</div>
<div class="paragraph">
<p>produces the following output into the log:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">hello_world</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="nodes-relationships"><a class="link" href="#nodes-relationships">Node, Relationship and Path Functions and Procedures</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Functions and procedures to efficiently find and navigate and dynamically create and update nodes and relationships.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#path-functions">Path Functions</a></p>
</li>
<li>
<p><a href="#node-lookup">Lookup and Manipulation Procedures</a></p>
</li>
<li>
<p><a href="#node-functions">Node Functions</a></p>
</li>
<li>
<p><a href="#data-creation">Creating Data</a></p>
</li>
<li>
<p><a href="#locking">Locking</a></p>
</li>
<li>
<p><a href="#graph-generators">Generating Graphs</a></p>
</li>
<li>
<p><a href="#parallel-node-search">Parallel Node Search</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="path-functions"><a class="link" href="#path-functions">Path Functions</a></h3>
<div class="paragraph">
<p>Functions to create, combine and split paths</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>apoc.path.create(startNode,[rels])</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">creates a path instance of the given elements</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>apoc.path.slice(path, [offset], [length])</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">creates a sub-path with the given offset and length</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>apoc.path.combine(path1, path2)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">combines the paths into one if the connecting node matches</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>apoc.path.elements(path)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">returns a list of node-relationship-node-&#8230;&#8203;</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="node-lookup"><a class="link" href="#node-lookup">Lookup and Manipulation Procedures</a></h3>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL apoc.nodes.get(node|nodes|id|[ids])</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">quickly returns all nodes with these ids</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL apoc.get.rels(rel|id|[ids])</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">quickly returns all relationships with these ids</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL apoc.nodes.delete(node|nodes|id|[ids])</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">quickly delete all nodes with these ids</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="node-functions"><a class="link" href="#node-functions">Node Functions</a></h3>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>apoc.nodes.isDense(node)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">returns true if it is a dense node</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>apoc.nodes.connected(start, end, rel-direction-pattern)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">returns true when the node is connected to the other node, optimized for dense nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>apoc.node.relationship.exists(node, rel-direction-pattern)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">returns true when the node has the relationships of the pattern</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>apoc.node.relationship.types(node, rel-direction-pattern)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">returns a list of distinct relationship types</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>apoc.node.degree(node, rel-direction-pattern)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">returns total degrees of the given relationships in the pattern, can use <code>'&gt;'</code> or <code>'&lt;'</code> for all outgoing or incoming relationships</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>apoc.node.id(node)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">returns id for (virtual) nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>apoc.node.degree.in(node, relationshipName)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">returns total number of incoming relationship</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>apoc.node.degree.out(node, relationshipName)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">returns total number of outgoing relationship</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>apoc.node.labels(node)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">returns labels for (virtual) nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>apoc.rel.id(rel)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">returns id for (virtual) relationships</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>apoc.rel.type(rel)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">returns type for (virtual) relationships</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>apoc.any.properties(node/rel/map, <a id="keys"></a>)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">returns properties for virtual and real, nodes, rels and maps, optionally restrict via keys</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>apoc.any.property(node/rel/map)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">returns property for virtual and real, nodes, rels and maps</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>apoc.create.uuid()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">returns a UUID string</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>apoc.label.exists(element, label)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">returns true or false related to label existance</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>rel-direction-pattern syntax:</p>
</div>
<div class="paragraph">
<p><code>[&lt;]RELATIONSHIP_TYPE1[&gt;]|[&lt;]RELATIONSHIP_TYPE2[&gt;]|&#8230;&#8203;</code></p>
</div>
<div class="paragraph">
<p>Example: <code>'FRIEND|MENTORS&gt;|&lt;REPORTS_TO'</code> will match to :FRIEND relationships in either direction, outgoing :MENTORS relationships, and incoming :REPORTS_TO relationships.</p>
</div>
</div>
<div class="sect2">
<h3 id="data-creation"><a class="link" href="#data-creation">Creating Data</a></h3>
<iframe width="560" height="315" src="https://www.youtube.com/embed/KsAb8QHClNg" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL apoc.create.node(['Label'], {key:value,&#8230;&#8203;})</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">create node with dynamic labels</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL apoc.create.nodes(['Label'], [{key:value,&#8230;&#8203;}])</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">create multiple nodes with dynamic labels</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL apoc.create.addLabels( [node,id,ids,nodes], ['Label',&#8230;&#8203;])</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">adds the given labels to the node or nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL apoc.create.removeLabels( [node,id,ids,nodes], ['Label',&#8230;&#8203;])</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">removes the given labels from the node or nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL apoc.create.setProperty( [node,id,ids,nodes], key, value)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">sets the given property on the node(s)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL apoc.create.setProperties( [node,id,ids,nodes], [keys], [values])</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">sets the given property on the nodes(s)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL apoc.create.setRelProperty( [rel,id,ids,rels], key, value)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">sets the given property on the relationship(s)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL apoc.create.setRelProperties( [rel,id,ids,rels], [keys], [values])</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">sets the given property on the relationship(s)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL apoc.create.relationship(person1,'KNOWS',{key:value,&#8230;&#8203;}, person2)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">create relationship with dynamic rel-type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL apoc.create.uuids(count) YIELD uuid, row</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">creates count UUIDs</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL apoc.nodes.link([nodes],'REL_TYPE')</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">creates a linked list of nodes from first to last</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="locking"><a class="link" href="#locking">Locking</a></h3>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>call apoc.lock.nodes([nodes])</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">acquires a write lock on the given nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>call apoc.lock.rels([relationships])</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">acquires a write lock on the given relationship</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>call apoc.lock.all([nodes],[relationships])</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">acquires a write lock on the given nodes and relationships</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="graph-generators"><a class="link" href="#graph-generators">Generating Graphs</a></h3>
<div class="paragraph">
<p>Generate undirected (random direction) graphs with semi-real random distributions based on theoretical models.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>apoc.generate.er(noNodes, noEdges, 'label', 'type')</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">generates a graph according to Erdos-Renyi model (uniform)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>apoc.generate.ws(noNodes, degree, beta, 'label', 'type')</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">generates a graph according to Watts-Strogatz model (clusters)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>apoc.generate.ba(noNodes, edgesPerNode, 'label', 'type')</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">generates a graph according to Barabasi-Albert model (preferential attachment)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>apoc.generate.complete(noNodes, 'label', 'type')</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">generates a complete graph (all nodes connected to all other nodes)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>apoc.generate.simple([degrees], 'label', 'type')</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">generates a graph with the given degree distribution</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Example</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL apoc.generate.ba(1000, 2, 'TestLabel', 'TEST_REL_TYPE')
CALL apoc.generate.ws(1000, null, null, null)
CALL apoc.generate.simple([2,2,2,2], null, null)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="parallel-node-search"><a class="link" href="#parallel-node-search">Parallel Node Search</a></h3>
<div class="paragraph">
<p>Utility to find nodes in parallel (if possible). These procedures return a single list of nodes or a list of 'reduced' records with node id, labels, and the properties where the search was executed upon.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 55.5555%;">
<col style="width: 44.4445%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>call apoc.search.node(labelPropertyMap, searchType, search ) yield node</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A distinct set of Nodes will be returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>call apoc.search.nodeAll(labelPropertyMap, searchType, search ) yield node</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All the found Nodes will be returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>call apoc.search.nodeReduced(labelPropertyMap, searchType, search ) yield id, labels, values</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A merged set of 'minimal' Node information will be returned. One record per node (-id).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>call apoc.search.nodeAllReduced(labelPropertyMap, searchType, search ) yield id, labels, values</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All the found 'minimal' Node information will be returned. One record per label and property.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 12.5%;">
<col style="width: 50%;">
<col style="width: 37.5%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>labelPropertyMap</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>'{ label1 : "propertyOne", label2 :["propOne","propTwo"] }'</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(JSON or Map) For every Label-Property combination a search will be executed in parallel (if possible): Label1.propertyOne, label2.propOne and label2.propTwo.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>searchType</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'exact' or 'contains' or 'starts with' or 'ends with'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Case insensitive string search operators</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>searchType</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"&lt;", "&gt;", "=", "&lt;&gt;", "&#8656;", "&gt;=", "=~"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Operators</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>search</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'Keanu'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The actual search term (string, number, etc).</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">example</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL apoc.search.nodeAll('{Person: "name",Movie: ["title","tagline"]}','contains','her') YIELD node AS n RETURN n
call apoc.search.nodeReduced({Person: 'born', Movie: ['released']},'&gt;',2000) yield id, labels, properties RETURN *</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="path-finding"><a class="link" href="#path-finding">Path Finding</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>APOC exposes some built in path-finding functions that Neo4j brings along.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>apoc.algo.dijkstra(startNode, endNode, 'KNOWS|&lt;WORKS_WITH|IS_MANAGER_OF&gt;', 'distance') YIELD path, weight</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">run dijkstra with relationship property name as cost function</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>apoc.algo.dijkstraWithDefaultWeight(startNode, endNode, 'KNOWS|&lt;WORKS_WITH|IS_MANAGER_OF&gt;',  'distance', 10) YIELD path, weight</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">run dijkstra with relationship property name as cost function and a default weight if the property does not exist</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>apoc.algo.aStar(startNode, endNode, 'KNOWS|&lt;WORKS_WITH|IS_MANAGER_OF&gt;', 'distance','lat','lon')  YIELD path, weight</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">run A* with relationship property name as cost function</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>apoc.algo.aStar(startNode, endNode, 'KNOWS|&lt;WORKS_WITH|IS_MANAGER_OF&gt;', {weight:'dist',default:10, x:'lon',y:'lat'}) YIELD path, weight</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">run A* with relationship property name as cost function</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>apoc.algo.allSimplePaths(startNode, endNode, 'KNOWS|&lt;WORKS_WITH|IS_MANAGER_OF&gt;', 5) YIELD path,  weight</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">run allSimplePaths with relationships given and maxNodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>apoc.stats.degrees(relTypesDirections) yield type, direction, total, min, max, mean, p50, p75, p90, p95, p99, p999</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">compute degree distribution in parallel</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Example: find the weighted shortest path based on relationship property <code>d</code> from <code>A</code> to <code>B</code> following just <code>:ROAD</code> relationships</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">MATCH (from:Loc{name:'A'}), (to:Loc{name:'D'})
CALL apoc.algo.dijkstra(from, to, 'ROAD', 'd') yield path as path, weight as weight
RETURN path, weight</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="path-expander"><a class="link" href="#path-expander">Path Expander</a></h3>
<div class="paragraph">
<p>Thanks to Andrew Bowman (@inversefalcon) and Kees Vegter (@keesvegter)</p>
</div>
<div class="paragraph">
<p>The apoc.path.expand procedure makes it possible to do variable length path traversals where you can specify the direction of the relationship per relationship type and a list of Label names which act as a "whitelist" or a "blacklist" or define end nodes for the expansion. The procedure will return a list of Paths in a variable name called "path".</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>call apoc.path.expand(startNode &lt;id&gt;|Node, relationshipFilter, labelFilter, minDepth, maxDepth ) yield path as &lt;identifier&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">expand from given nodes(s) taking the provided restrictions into account</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Variations allow more configurable expansions, and expansions for more specific use cases:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>call apoc.path.expandConfig(startNode &lt;id&gt;Node/list, {minLevel, maxLevel, relationshipFilter, labelFilter, bfs:true, uniqueness:'RELATIONSHIP_PATH', filterStartNode:true, limit, optional:false, endNodes, terminatorNodes, sequence, beginSequenceAtStart:true}) yield path</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">expand from given nodes(s) taking the provided restrictions into account</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>call apoc.path.subgraphNodes(startNode &lt;id&gt;Node/list, {maxLevel, relationshipFilter, labelFilter, bfs:true, filterStartNode:true, limit, optional:false, endNodes, terminatorNodes, sequence, beginSequenceAtStart:true}) yield node</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">expand a subgraph from given nodes(s) taking the provided restrictions into account; returns all nodes in the subgraph</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>call apoc.path.subgraphAll(startNode &lt;id&gt;Node/list, {maxLevel, relationshipFilter, labelFilter, bfs:true, filterStartNode:true, limit, endNodes, terminatorNodes, sequence, beginSequenceAtStart:true}) yield nodes, relationships</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">expand a subgraph from given nodes(s) taking the provided restrictions into account; returns the collection of subgraph nodes, and the collection of all relationships within the subgraph</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>call apoc.path.spanningTree(startNode &lt;id&gt;Node/list, {maxLevel, relationshipFilter, labelFilter, bfs:true, filterStartNode:true, limit, optional:false, endNodes, terminatorNodes, sequence, beginSequenceAtStart:true}) yield path</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">expand a spanning tree from given nodes(s) taking the provided restrictions into account; the paths returned collectively form a spanning tree</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="_relationship_filter"><a class="link" href="#_relationship_filter">Relationship Filter</a></h4>
<div class="paragraph">
<p>Syntax: <code>[&lt;]RELATIONSHIP_TYPE1[&gt;]|[&lt;]RELATIONSHIP_TYPE2[&gt;]|&#8230;&#8203;</code></p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">input</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">direction</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LIKES&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LIKES</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>OUTGOING</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;FOLLOWS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FOLLOWS</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>INCOMING</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>KNOWS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>KNOWS</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>BOTH</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>any type</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>OUTGOING</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>any type</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>INCOMING</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_label_filter"><a class="link" href="#_label_filter">Label Filter</a></h4>
<div class="paragraph">
<p>Syntax: <code>[+-/&gt;]LABEL1|LABEL2|*|&#8230;&#8203;</code></p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">input</th>
<th class="tableblock halign-left valign-top">result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-Foe</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>blacklist filter - No node in the path will have a label in the blacklist.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>+Friend</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>whitelist filter - All nodes in the path must have a label in the whitelist (exempting termination and end nodes, if using those filters).
If no whitelist operator is present, all labels are considered whitelisted.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/Friend</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>termination filter - Only return paths up to a node of the given labels, and stop further expansion beyond it.
Termination nodes do not have to respect the whitelist. Termination filtering takes precedence over end node filtering.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&gt;Friend</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>end node filter - Only return paths up to a node of the given labels, but continue expansion to match on end nodes beyond it.
End nodes do not have to respect the whitelist to be returned, but expansion beyond them is only allowed if the node has a label in the whitelist.</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">Syntax Changes</div>
<p>As of APOC 3.1.3.x multiple label filter operations are allowed.
In prior versions, only one type of operation is allowed in the label filter (<code>+</code> or <code>-</code> or <code>/</code> or <code>&gt;</code>, never more than one).</p>
</div>
<div class="paragraph">
<p>With APOC 3.2.x.x, label filters will no longer apply to starting nodes of the expansion by default, but this can be toggled with the <code>filterStartNode</code> config parameter.</p>
</div>
<div class="paragraph">
<p>With the APOC releases in January 2018, some behavior has changed in the label filters:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">filter</th>
<th class="tableblock halign-left valign-top">changed behavior</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>No filter</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Now indicates the label is whitelisted, same as if it were prefixed with <code>+</code>.
Previously, a label without a filter symbol reused the previously used symbol.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><code>&gt;</code> (end node filter)</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The label is additionally whitelisted, so expansion will always continue beyond an end node (unless prevented by the blacklist).
Previously, expansion would only continue if allowed by the whitelist and not disallowed by the blacklist.
This also applies at a depth below <code>minLevel</code>, allowing expansion to continue.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><code>/</code> (termination filter)</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>When at depth below <code>minLevel</code>, expansion is allowed to continue and no pruning will take place (unless prevented by the blacklist).
Previously, expansion would only continue if allowed by the whitelist and not disallowed by the blacklist.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>All filters</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>*</code> is allowed as a standin for all labels.
Additionally, compound labels are supported (like <code>Person:Manager</code>), and only apply to nodes with all of those labels present (order agnositic).</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_sequences"><a class="link" href="#_sequences">Sequences</a></h4>
<div class="paragraph">
<p>Introduced in the February 2018 APOC releases, path expander procedures can expand on repeating sequences of labels, relationship types, or both.</p>
</div>
<div class="paragraph">
<p>If only using label sequences, just use the <code>labelFilter</code>, but use commas to separate the filtering for each step in the repeating sequence.</p>
</div>
<div class="paragraph">
<p>If only using relationship sequences, just use the <code>relationshipFilter</code>, but use commas to separate the filtering for each step of the repeating sequence.</p>
</div>
<div class="paragraph">
<p>If using sequences of both relationships and labels, use the <code>sequence</code> parameter.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Usage</th>
<th class="tableblock halign-left valign-top">config param</th>
<th class="tableblock halign-left valign-top">description</th>
<th class="tableblock halign-left valign-top">syntax</th>
<th class="tableblock halign-left valign-top">explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>label sequences only</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>labelFilter</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Same syntax and filters, but uses commas (<code>,</code>) to separate the filters for each step in the sequence.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>labelFilter:'Post|-Blocked,Reply,&gt;Admin'</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Start node must be a :Post node that isn&#8217;t :Blocked, next node must be a :Reply, and the next must be an :Admin, then repeat if able. Only paths ending with the <code>:Admin</code> node in that position of the sequence will be returned.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>relationship sequences only</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>relationshipFilter</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Same syntax, but uses commas (<code>,</code>) to separate the filters for each relationship traversal in the sequence.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>relationshipFilter:'NEXT&gt;,&lt;FROM,POSTED&gt;|REPLIED&gt;'</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Expansion will first expand <code>NEXT&gt;</code> from the start node, then <code>&lt;FROM</code>, then either <code>POSTED&gt;</code> or <code>REPLIED&gt;</code>, then repeat if able.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>sequences of both labels and relationships</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sequence</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A string of comma-separated alternating label and relationship filters, for each step in a repeating sequence. The sequence should begin with a label filter, and end with a relationship filter. If present, <code>labelFilter</code>, and <code>relationshipFilter</code> are ignored, as this takes priority.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sequence:'Post|-Blocked, NEXT&gt;, Reply, &lt;FROM, &gt;Admin, POSTED&gt;|REPLIED&gt;'</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Combines the behaviors above.</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="sect4">
<h5 id="_starting_the_sequence_at_one_off_from_the_start_node"><a class="link" href="#_starting_the_sequence_at_one_off_from_the_start_node">Starting the sequence at one-off from the start node</a></h5>
<div class="paragraph">
<p>There are some uses cases where the sequence does not begin at the start node, but at one node distant.</p>
</div>
<div class="paragraph">
<p>A new config parameter, <code>beginSequenceAtStart</code>, can toggle this behavior.</p>
</div>
<div class="paragraph">
<p>Default value is <code>true</code>.</p>
</div>
<div class="paragraph">
<p>If set to <code>false</code>, this changes the expected values for <code>labelFilter</code>, <code>relationshipFilter</code>, and <code>sequence</code> as noted below:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">sequence</th>
<th class="tableblock halign-left valign-top">altered behavior</th>
<th class="tableblock halign-left valign-top">example</th>
<th class="tableblock halign-left valign-top">explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>labelFilter</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The start node is not considered part of the sequence. The sequence begins one node off from the start node.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>beginSequenceAtStart:false, labelFilter:'Post|-Blocked,Reply,&gt;Admin'</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The next node(s) out from the start node begins the sequence (and must be a :Post node that isn&#8217;t :Blocked), and only paths ending with <code>Admin</code> nodes returned.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>relationshipFilter</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The first relationship filter in the sequence string will not be considered part of the repeating sequence, and will only be used for the first relationship from the start node to the node that will be the actual start of the sequence.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>beginSequenceAtStart:false, relationshipFilter:'FIRST&gt;,NEXT&gt;,&lt;FROM,POSTED&gt;|REPLIED&gt;'</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>FIRST&gt;</code> will be traversed just from the start node to the node that will be the start of the repeating <code>NEXT&gt;,&lt;FROM,POSTED&gt;|REPLIED&gt;</code> sequence.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sequence</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Combines the above two behaviors.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>beginSequenceAtStart:false, sequence:'FIRST&gt;, Post|-Blocked, NEXT&gt;, Reply, &lt;FROM, &gt;Admin, POSTED&gt;|REPLIED&gt;'</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Combines the behaviors above.</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">Sequence tips</div>
<p>Label filtering in sequences work together with the <code>endNodes</code>+<code>terminatorNodes</code>, though inclusion of a node must be unanimous.</p>
</div>
<div class="paragraph">
<p>Remember that <code>filterStartNode</code> defaults to <code>false</code> for APOC 3.2.x.x and newer. If you want the start node filtered according to the first step in the sequence, you may need to set this explicitly to <code>true</code>.</p>
</div>
<div class="paragraph">
<p>If you need to limit the number of times a sequence repeats, this can be done with the <code>maxLevel</code> config param (multiply the number of iterations with the size of the nodes in the sequence).</p>
</div>
<div class="paragraph">
<p>As paths are important when expanding sequences, we recommend avoiding <code>apoc.path.subgraphNodes()</code>, <code>apoc.path.subgraphAll()</code>, and <code>apoc.path.spanningTree()</code> when using sequences,
as the configurations that make these efficient at matching to distinct nodes may interfere with sequence pathfinding.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_uniqueness"><a class="link" href="#_uniqueness">Uniqueness</a></h4>
<div class="paragraph">
<p>Uniqueness of nodes and relationships guides the expansion and the returned results.
Uniqueness is only configurable using <code>expandConfig()</code>.</p>
</div>
<div class="paragraph">
<p><code>subgraphNodes()</code>, <code>subgraphAll()</code>, and <code>spanningTree()</code> all use 'NODE_GLOBAL' uniqueness.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">value</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RELATIONSHIP_PATH</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>For each returned node there&#8217;s a (relationship wise) unique path from the start node to it. This is Cypher&#8217;s default expansion mode.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NODE_GLOBAL</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A node cannot be traversed more than once. This is what the legacy traversal framework does.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NODE_LEVEL</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Entities on the same level are guaranteed to be unique.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NODE_PATH</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>For each returned node there&#8217;s a unique path from the start node to it.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NODE_RECENT</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>This is like NODE_GLOBAL, but only guarantees uniqueness among the most recent visited nodes, with a configurable count. Traversing a huge graph is quite memory intensive in that it keeps track of all the nodes it has visited.
For huge graphs a traverser can hog all the memory in the JVM, causing OutOfMemoryError. Together with this Uniqueness you can supply a count, which is the number of most recent visited nodes. This can cause a node to be visited more than once, but scales infinitely.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RELATIONSHIP_GLOBAL</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A relationship cannot be traversed more than once, whereas nodes can.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RELATIONSHIP_LEVEL</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Entities on the same level are guaranteed to be unique.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RELATIONSHIP_RECENT</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Same as for NODE_RECENT, but for relationships.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NONE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>No restriction (the user will have to manage it)</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_node_filters"><a class="link" href="#_node_filters">Node Filters</a></h4>
<div class="paragraph">
<p>While label filters use labels to allow whitelisting, blacklisting, and restrictions on which kind of nodes can end or terminate expansion,
you can also filter based upon actual nodes.</p>
</div>
<div class="paragraph">
<p>Each of these config parameter accepts a list of nodes, or a list of node ids.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">config parameter</th>
<th class="tableblock halign-left valign-top">description</th>
<th class="tableblock halign-left valign-top">added in</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>endNodes</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Only these nodes can end returned paths, and expansion will continue past these nodes, if possible.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Winter 2018 APOC releases.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>terminatorNodes</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Only these nodes can end returned paths, and expansion won&#8217;t continue past these nodes.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Winter 2018 APOC releases.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>whitelistNodes</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Only these nodes are allowed in the expansion (though endNodes and terminatorNodes will also be allowed, if present).</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Spring 2018 APOC releases.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>blacklistNodes</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>None of the paths returned will include these nodes.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Spring 2018 APOC releases.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_expand_paths"><a class="link" href="#_expand_paths">Expand paths</a></h4>
<div class="paragraph">
<p>Expand from start node following the given relationships from min to max-level adhering to the label filters. Several variations exist:</p>
</div>
<div class="paragraph">
<p><code>apoc.path.expand()</code> expands paths using Cypher&#8217;s default expansion modes (bfs and 'RELATIONSHIP_PATH' uniqueness)</p>
</div>
<div class="paragraph">
<p><code>apoc.path.expandConfig()</code> allows more flexible configuration of parameters and expansion modes</p>
</div>
<div class="paragraph">
<p><code>apoc.path.subgraphNodes()</code> expands to nodes of a subgraph</p>
</div>
<div class="paragraph">
<p><code>apoc.path.subgraphAll()</code> expands to nodes of a subgraph and also returns all relationships in the subgraph</p>
</div>
<div class="paragraph">
<p><code>apoc.path.spanningTree()</code> expands to paths collectively forming a spanning tree</p>
</div>
</div>
<div class="sect3">
<h4 id="_expand"><a class="link" href="#_expand">Expand</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL apoc.path.expand(startNode &lt;id&gt;|Node, relationshipFilter, labelFilter, minLevel, maxLevel )

CALL apoc.path.expand(startNode &lt;id&gt;|Node|list, 'TYPE|TYPE_OUT&gt;|&lt;TYPE_IN', '+YesLabel|-NoLabel|/TerminationLabel|&gt;EndNodeLabel', minLevel, maxLevel ) yield path</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_relationship_filter_2"><a class="link" href="#_relationship_filter_2">Relationship Filter</a></h4>
<div class="paragraph">
<p>Syntax: <code>[&lt;]RELATIONSHIP_TYPE1[&gt;]|[&lt;]RELATIONSHIP_TYPE2[&gt;]|&#8230;&#8203;</code></p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">input</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">direction</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LIKES&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LIKES</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>OUTGOING</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;FOLLOWS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FOLLOWS</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>INCOMING</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>KNOWS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>KNOWS</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>BOTH</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>any type</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>OUTGOING</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>any type</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>INCOMING</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_label_filter_2"><a class="link" href="#_label_filter_2">Label Filter</a></h4>
<div class="paragraph">
<p>Syntax: <code>[+-/&gt;]LABEL1|LABEL2|*|&#8230;&#8203;</code></p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">input</th>
<th class="tableblock halign-left valign-top">result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-Foe</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>blacklist filter - No node in the path will have a label in the blacklist.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>+Friend</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>whitelist filter - All nodes in the path must have a label in the whitelist (exempting termination and end nodes, if using those filters).
If no whitelist operator is present, all labels are considered whitelisted.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/Friend</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>termination filter - Only return paths up to a node of the given labels, and stop further expansion beyond it.
Termination nodes do not have to respect the whitelist. Termination filtering takes precedence over end node filtering.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&gt;Friend</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>end node filter - Only return paths up to a node of the given labels, but continue expansion to match on end nodes beyond it.
End nodes do not have to respect the whitelist to be returned, but expansion beyond them is only allowed if the node has a label in the whitelist.</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">Syntax Changes</div>
<p>As of APOC 3.1.3.x multiple label filter operations are allowed.
In prior versions, only one type of operation is allowed in the label filter (<code>+</code> or <code>-</code> or <code>/</code> or <code>&gt;</code>, never more than one).</p>
</div>
<div class="paragraph">
<p>With APOC 3.2.x.x, label filters will no longer apply to starting nodes of the expansion by default, but this can be toggled with the <code>filterStartNode</code> config parameter.</p>
</div>
<div class="paragraph">
<p>With the APOC releases in January 2018, some behavior has changed in the label filters:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">filter</th>
<th class="tableblock halign-left valign-top">changed behavior</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>No filter</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Now indicates the label is whitelisted, same as if it were prefixed with <code>+</code>.
Previously, a label without a filter symbol reused the previously used symbol.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><code>&gt;</code> (end node filter)</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The label is additionally whitelisted, so expansion will always continue beyond an end node (unless prevented by the blacklist).
Previously, expansion would only continue if allowed by the whitelist and not disallowed by the blacklist.
This also applies at a depth below <code>minLevel</code>, allowing expansion to continue.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><code>/</code> (termination filter)</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>When at depth below <code>minLevel</code>, expansion is allowed to continue and no pruning will take place (unless prevented by the blacklist).
Previously, expansion would only continue if allowed by the whitelist and not disallowed by the blacklist.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>All filters</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>*</code> is allowed as a standin for all labels.
Additionally, compound labels are supported (like <code>Person:Manager</code>), and only apply to nodes with all of those labels present (order agnositic).</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">call apoc.path.expand(1,"ACTED_IN&gt;|PRODUCED&lt;|FOLLOWS&lt;","+Movie|Person",0,3)
call apoc.path.expand(1,"ACTED_IN&gt;|PRODUCED&lt;|FOLLOWS&lt;","-BigBrother",0,3)
call apoc.path.expand(1,"ACTED_IN&gt;|PRODUCED&lt;|FOLLOWS&lt;","",0,3)

// combined with cypher:

match (tom:Person {name :"Tom Hanks"})
call apoc.path.expand(tom,"ACTED_IN&gt;|PRODUCED&lt;|FOLLOWS&lt;","+Movie|Person",0,3) yield path as pp
return pp;

// or

match (p:Person) with p limit 3
call apoc.path.expand(p,"ACTED_IN&gt;|PRODUCED&lt;|FOLLOWS&lt;","+Movie|Person",1,2) yield path as pp
return p, pp</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Termination and end node label filter example</div>
<p>We will first set a <code>:Western</code> label on some nodes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">match (p:Person)
where p.name in ['Clint Eastwood', 'Gene Hackman']
set p:Western</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now expand from 'Keanu Reeves' to all <code>:Western</code> nodes with a termination filter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">match (k:Person {name:'Keanu Reeves'})
call apoc.path.expandConfig(k, {relationshipFilter:'ACTED_IN|PRODUCED|DIRECTED', labelFilter:'/Western', uniqueness: 'NODE_GLOBAL'}) yield path
return path</code></pre>
</div>
</div>
<div class="paragraph">
<p>The one returned path only matches up to 'Gene Hackman'.
While there is a path from 'Keanu Reeves' to 'Clint Eastwood' through 'Gene Hackman', no further expansion is permitted through a node in the termination filter.</p>
</div>
<div class="paragraph">
<p>If you didn&#8217;t want to stop expansion on reaching 'Gene Hackman', and wanted 'Clint Eastwood' returned as well, use the end node filter  instead (<code>&gt;</code>).</p>
</div>
<div class="paragraph">
<div class="title">Label filter operator precedence and behavior</div>
<p>As of APOC 3.1.3.x, multiple label filter operators are allowed at the same time.</p>
</div>
<div class="paragraph">
<p>When processing the labelFilter string, once a filter operator is introduced, it remains the active filter until another filter supplants it.
(Not applicable after February 2018 release, as no filter will now mean the label is whitelisted).</p>
</div>
<div class="paragraph">
<p>In the following example, <code>:Person</code> and <code>:Movie</code> labels are whitelisted, <code>:SciFi</code> is blacklisted, with <code>:Western</code> acting as an end node label, and <code>:Romance</code> acting as a termination label.</p>
</div>
<div class="paragraph">
<p><code>&#8230;&#8203; labelFilter:'+Person|Movie|-SciFi|&gt;Western|/Romance' &#8230;&#8203;</code></p>
</div>
<div class="paragraph">
<p>The precedence of operator evaluation isn&#8217;t dependent upon their location in the labelFilter but is fixed:</p>
</div>
<div class="paragraph">
<p>Blacklist filter <code>-</code>, termination filter <code>/</code>, end node filter <code>&gt;</code>, whitelist filter <code>+</code>.</p>
</div>
<div class="paragraph">
<p>The consequences are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>No blacklisted label <code>-</code> will ever be present in the nodes of paths returned, no matter if the same label (or another label of a node with a blacklisted label) is included in another filter list.</p>
</li>
<li>
<p>If the termination filter <code>/</code> or end node filter <code>&gt;</code> is used, then only paths up to nodes with those labels will be returned as results. These end nodes are exempt from the whitelist filter.</p>
</li>
<li>
<p>If a node is a termination node <code>/</code>, no further expansion beyond the node will occur.</p>
</li>
<li>
<p>If a node is an end node <code>&gt;</code>, expansion beyond that node will only occur if the end node has a label in the whitelist. This is to prevent returning paths to nodes where a node on that path violates the whitelist.
(this no longer applies in releases after February 2018)</p>
</li>
<li>
<p>The whitelist only applies to nodes up to but not including end nodes from the termination or end node filters. If no end node or termination node operators are present, then the whitelist applies to all nodes of the path.</p>
</li>
<li>
<p>If no whitelist operators are present in the labelFilter, this is treated as if all labels are whitelisted.</p>
</li>
<li>
<p>If <code>filterStartNode</code> is false (which will be default in APOC 3.2.x.x), then the start node is exempt from the label filter.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_sequences_2"><a class="link" href="#_sequences_2">Sequences</a></h4>
<div class="paragraph">
<p>Introduced in the February 2018 APOC releases, path expander procedures can expand on repeating sequences of labels, relationship types, or both.</p>
</div>
<div class="paragraph">
<p>If only using label sequences, just use the <code>labelFilter</code>, but use commas to separate the filtering for each step in the repeating sequence.</p>
</div>
<div class="paragraph">
<p>If only using relationship sequences, just use the <code>relationshipFilter</code>, but use commas to separate the filtering for each step of the repeating sequence.</p>
</div>
<div class="paragraph">
<p>If using sequences of both relationships and labels, use the <code>sequence</code> parameter.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Usage</th>
<th class="tableblock halign-left valign-top">config param</th>
<th class="tableblock halign-left valign-top">description</th>
<th class="tableblock halign-left valign-top">syntax</th>
<th class="tableblock halign-left valign-top">explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>label sequences only</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>labelFilter</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Same syntax and filters, but uses commas (<code>,</code>) to separate the filters for each step in the sequence.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>labelFilter:'Post|-Blocked,Reply,&gt;Admin'</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Start node must be a :Post node that isn&#8217;t :Blocked, next node must be a :Reply, and the next must be an :Admin, then repeat if able. Only paths ending with the <code>:Admin</code> node in that position of the sequence will be returned.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>relationship sequences only</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>relationshipFilter</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Same syntax, but uses commas (<code>,</code>) to separate the filters for each relationship traversal in the sequence.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>relationshipFilter:'NEXT&gt;,&lt;FROM,POSTED&gt;|REPLIED&gt;'</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Expansion will first expand <code>NEXT&gt;</code> from the start node, then <code>&lt;FROM</code>, then either <code>POSTED&gt;</code> or <code>REPLIED&gt;</code>, then repeat if able.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>sequences of both labels and relationships</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sequence</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A string of comma-separated alternating label and relationship filters, for each step in a repeating sequence. The sequence should begin with a label filter, and end with a relationship filter. If present, <code>labelFilter</code>, and <code>relationshipFilter</code> are ignored, as this takes priority.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sequence:'Post|-Blocked, NEXT&gt;, Reply, &lt;FROM, &gt;Admin, POSTED&gt;|REPLIED&gt;'</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Combines the behaviors above.</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="sect4">
<h5 id="_starting_the_sequence_at_one_off_from_the_start_node_2"><a class="link" href="#_starting_the_sequence_at_one_off_from_the_start_node_2">Starting the sequence at one-off from the start node</a></h5>
<div class="paragraph">
<p>There are some uses cases where the sequence does not begin at the start node, but at one node distant.</p>
</div>
<div class="paragraph">
<p>A new config parameter, <code>beginSequenceAtStart</code>, can toggle this behavior.</p>
</div>
<div class="paragraph">
<p>Default value is <code>true</code>.</p>
</div>
<div class="paragraph">
<p>If set to <code>false</code>, this changes the expected values for <code>labelFilter</code>, <code>relationshipFilter</code>, and <code>sequence</code> as noted below:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">sequence</th>
<th class="tableblock halign-left valign-top">altered behavior</th>
<th class="tableblock halign-left valign-top">example</th>
<th class="tableblock halign-left valign-top">explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>labelFilter</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The start node is not considered part of the sequence. The sequence begins one node off from the start node.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>beginSequenceAtStart:false, labelFilter:'Post|-Blocked,Reply,&gt;Admin'</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The next node(s) out from the start node begins the sequence (and must be a :Post node that isn&#8217;t :Blocked), and only paths ending with <code>Admin</code> nodes returned.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>relationshipFilter</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The first relationship filter in the sequence string will not be considered part of the repeating sequence, and will only be used for the first relationship from the start node to the node that will be the actual start of the sequence.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>beginSequenceAtStart:false, relationshipFilter:'FIRST&gt;,NEXT&gt;,&lt;FROM,POSTED&gt;|REPLIED&gt;'</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>FIRST&gt;</code> will be traversed just from the start node to the node that will be the start of the repeating <code>NEXT&gt;,&lt;FROM,POSTED&gt;|REPLIED&gt;</code> sequence.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sequence</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Combines the above two behaviors.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>beginSequenceAtStart:false, sequence:'FIRST&gt;, Post|-Blocked, NEXT&gt;, Reply, &lt;FROM, &gt;Admin, POSTED&gt;|REPLIED&gt;'</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Combines the behaviors above.</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">Sequence tips</div>
<p>Label filtering in sequences work together with the <code>endNodes</code>+<code>terminatorNodes</code>, though inclusion of a node must be unanimous.</p>
</div>
<div class="paragraph">
<p>Remember that <code>filterStartNode</code> defaults to <code>false</code> for APOC 3.2.x.x and newer. If you want the start node filtered according to the first step in the sequence, you may need to set this explicitly to <code>true</code>.</p>
</div>
<div class="paragraph">
<p>If you need to limit the number of times a sequence repeats, this can be done with the <code>maxLevel</code> config param (multiply the number of iterations with the size of the nodes in the sequence).</p>
</div>
<div class="paragraph">
<p>As paths are important when expanding sequences, we recommend avoiding <code>apoc.path.subgraphNodes()</code>, <code>apoc.path.subgraphAll()</code>, and <code>apoc.path.spanningTree()</code> when using sequences,
as the configurations that make these efficient at matching to distinct nodes may interfere with sequence pathfinding.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_expand_with_config"><a class="link" href="#_expand_with_config">Expand with Config</a></h4>
<div class="listingblock">
<div class="content">
<pre>apoc.path.expandConfig(startNode &lt;id&gt;Node/list, {config}) yield path expands from start nodes using the given configuration and yields the resulting paths</pre>
</div>
</div>
<div class="paragraph">
<p>Takes an additional map parameter, <code>config</code>, to provide configuration options:</p>
</div>
<div class="listingblock">
<div class="title">Config</div>
<div class="content">
<pre>{minLevel: -1|number,
 maxLevel: -1|number,
 relationshipFilter: '[&lt;]RELATIONSHIP_TYPE1[&gt;]|[&lt;]RELATIONSHIP_TYPE2[&gt;], [&lt;]RELATIONSHIP_TYPE3[&gt;]|[&lt;]RELATIONSHIP_TYPE4[&gt;]',
 labelFilter: '[+-/&gt;]LABEL1|LABEL2|*,[+-/&gt;]LABEL1|LABEL2|*,...',
 uniqueness: RELATIONSHIP_PATH|NONE|NODE_GLOBAL|NODE_LEVEL|NODE_PATH|NODE_RECENT|
             RELATIONSHIP_GLOBAL|RELATIONSHIP_LEVEL|RELATIONSHIP_RECENT,
 bfs: true|false,
 filterStartNode: true|false,
 limit: -1|number,
 optional: true|false,
 endNodes: [nodes],
 terminatorNodes: [nodes],
 beginSequenceAtStart: true|false}</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_start_node_and_label_filters"><a class="link" href="#_start_node_and_label_filters">Start Node and label filters</a></h4>
<div class="paragraph">
<p>The config parameter <code>filterStartNode</code> defines whether or not the labelFilter (and <code>sequence</code>) applies to the start node of the expansion.</p>
</div>
<div class="paragraph">
<p>Use <code>filterStartNode: false</code> when you want your label filter to only apply to all other nodes in the path, ignoring the start node.</p>
</div>
<div class="paragraph">
<p><code>filterStartNode</code> defaults for all path expander procedures:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">version</th>
<th class="tableblock halign-left valign-top">default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>&gt;= APOC 3.2.x.x</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>filterStartNode = false</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>&lt; APOC 3.2.x.x</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>filterStartNode = true</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_limit"><a class="link" href="#_limit">Limit</a></h4>
<div class="paragraph">
<p>You can use the <code>limit</code> config parameter to limit the number of paths returned.</p>
</div>
<div class="paragraph">
<p>When using <code>bfs:true</code> (which is the default for all expand procedures), this has the effect of returning paths to the <code>n</code> nearest nodes with labels in the termination or end node filter, where <code>n</code> is the limit given.</p>
</div>
<div class="paragraph">
<p>The default limit value, <code>-1</code>, means no limit.</p>
</div>
<div class="paragraph">
<p>If you want to make sure multiple paths should never match to the same node, use <code>expandConfig()</code> with 'NODE_GLOBAL' uniqueness, or any expand procedure which already uses this uniqueness
(<code>subgraphNodes()</code>, <code>subgraphAll()</code>, and <code>spanningTree()</code>).</p>
</div>
</div>
<div class="sect3">
<h4 id="_optional"><a class="link" href="#_optional">Optional</a></h4>
<div class="paragraph">
<p>When <code>optional</code> is set to true, the path expansion is optional, much like an OPTIONAL MATCH, so a <code>null</code> value is yielded whenever the expansion would normally eliminate rows due to no results.</p>
</div>
<div class="paragraph">
<p>By default <code>optional</code> is false for all expansion procedures taking a config parameter.</p>
</div>
<div class="paragraph">
<div class="title">Uniqueness</div>
<p>Uniqueness of nodes and relationships guides the expansion and the results returned.
Uniqueness is only configurable using <code>expandConfig()</code>.</p>
</div>
<div class="paragraph">
<p><code>subgraphNodes()</code>, <code>subgraphAll()</code>, and <code>spanningTree()</code> all use 'NODE_GLOBAL' uniqueness.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">value</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RELATIONSHIP_PATH</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>For each returned node there&#8217;s a (relationship wise) unique path from the start node to it. This is Cypher&#8217;s default expansion mode.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NODE_GLOBAL</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A node cannot be traversed more than once. This is what the legacy traversal framework does.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NODE_LEVEL</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Entities on the same level are guaranteed to be unique.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NODE_PATH</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>For each returned node there&#8217;s a unique path from the start node to it.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NODE_RECENT</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>This is like NODE_GLOBAL, but only guarantees uniqueness among the most recent visited nodes, with a configurable count. Traversing a huge graph is quite memory intensive in that it keeps track of all the nodes it has visited.
For huge graphs a traverser can hog all the memory in the JVM, causing OutOfMemoryError. Together with this Uniqueness you can supply a count, which is the number of most recent visited nodes. This can cause a node to be visited more than once, but scales infinitely.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RELATIONSHIP_GLOBAL</code></p></t
